(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-23731482"],{1269:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("Navbar"),n("div",{staticClass:"py-5 container text-left"},[n("AdminNavbar"),n("h1",{staticClass:"mt-5 mb-4"},[t._v("會議室管理")]),n("div",{staticClass:"row col-md-6 mt-4 mb-4"},[n("form",{staticClass:"input-group mb-3",on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.createRoom(e)}}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.newRoom,expression:"newRoom"}],staticClass:"form-control",attrs:{type:"text",placeholder:"新增會議室名稱","aria-label":"Recipient's username","aria-describedby":"button-addon2"},domProps:{value:t.newRoom},on:{input:function(e){e.target.composing||(t.newRoom=e.target.value)}}}),n("div",{staticClass:"input-group-append"},[n("button",{staticClass:"btn btn-info",attrs:{type:"submit",disabled:t.isProcessing}},[t._v(" "+t._s(t.isProcessing?"處理中...":"新增會議室")+" ")])])])]),n("div",{staticClass:"row card-deck"},t._l(t.rooms,(function(e){return n("div",{key:e.id,staticClass:"col-md-4 mb-4"},[n("div",{staticClass:"card shadow opacity__background frosted__glass"},[n("div",{staticClass:"card-body"},[e.isEditing?n("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"room.name"}],staticClass:"mb-3",domProps:{value:e.name},on:{input:function(n){n.target.composing||t.$set(e,"name",n.target.value)}}}):n("h3",{staticClass:"card-title"},[t._v(t._s(e.name))]),e.isEditing?n("button",{staticClass:"btn btn-success mr-2",attrs:{disabled:t.isProcessing},on:{click:function(n){return n.preventDefault(),n.stopPropagation(),t.updateRoom({id:e.id,name:e.name})}}},[t._v(" "+t._s(t.isProcessing?"處理中...":"儲存")+" ")]):t._e(),e.isEditing?n("button",{staticClass:"btn btn-info mr-2",on:{click:function(n){return n.preventDefault(),n.stopPropagation(),t.toggleCancel(e.id)}}},[t._v(" 取消 ")]):n("button",{staticClass:"btn btn-info mr-2",on:{click:function(n){return n.preventDefault(),n.stopPropagation(),t.toggleEdit(e.id)}}},[t._v(" 修改 ")]),n("button",{staticClass:"btn btn-warning",attrs:{disabled:t.isProcessing},on:{click:function(n){return n.preventDefault(),n.stopPropagation(),t.deleteRoom(e.id)}}},[t._v(" 刪除 ")])])])])})),0)],1)],1)},s=[],a=n("1da1"),o=n("5530"),i=(n("96cf"),n("d81d"),n("b0c0"),n("498a"),n("d178")),c=n("7d03"),u=n("2fa3"),m=n("0ebf"),l=n("2f62"),d={computed:Object(o["a"])({},Object(l["b"])(["currentUser","isAuthenticated"])),name:"AdminRooms",components:{Navbar:i["a"],AdminNavbar:c["a"]},data:function(){return{rooms:{},newRoom:"",isProcessing:!1}},methods:{fetchData:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.isProcessing=!0,e.next=4,m["a"].getRooms();case 4:if(n=e.sent,200===n.status){e.next=7;break}throw new Error(n.statusText);case 7:t.rooms=n.data,t.rooms=n.data.map((function(t){return Object(o["a"])(Object(o["a"])({},t),{},{isEditing:!1,nameCatched:""})})),t.isProcessing=!1,e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](0),t.isProcessing=!1,console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))()},toggleEdit:function(t){this.rooms=this.rooms.map((function(e){return e.id===t?Object(o["a"])(Object(o["a"])({},e),{},{isEditing:!e.isEditing,nameCatched:e.name}):e}))},toggleCancel:function(t){this.rooms=this.rooms.map((function(e){return e.id===t?Object(o["a"])(Object(o["a"])({},e),{},{name:e.nameCatched,isEditing:!1}):e}))},updateRoom:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var r,s,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t.id,s=t.name,n.prev=1,e.isProcessing=!0,s.trim()){n.next=6;break}return e.isProcessing=!1,n.abrupt("return",e.$toast.show(" ","名稱不得為空",u["b"].options.info));case 6:return n.next=8,m["a"].updateRoom({id:r,name:s});case 8:if(a=n.sent,200===a.status){n.next=11;break}throw new Error(a.statusText);case 11:e.rooms=e.rooms.map((function(t){return t.id===r?Object(o["a"])(Object(o["a"])({},t),{},{isEditing:!1}):t})),e.isProcessing=!1,e.$toast.show(" ","名稱已成功修改",u["b"].options.success),n.next=21;break;case 16:n.prev=16,n.t0=n["catch"](1),e.isProcessing=!1,e.$toast.error(" ","修改失敗，請稍後再試",u["b"].options.error),console.log(n.t0);case 21:case"end":return n.stop()}}),n,null,[[1,16]])})))()},createRoom:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t.isProcessing=!0,t.newRoom.trim()){e.next=5;break}return t.isProcessing=!1,e.abrupt("return",t.$toast.show(" ","名稱不得為空",u["b"].options.info));case 5:return e.next=7,m["a"].createRoom({name:t.newRoom});case 7:if(n=e.sent,201===n.status){e.next=10;break}throw new Error(n.statusText);case 10:t.newRoom="",t.fetchData(),t.isProcessing=!1,t.$toast.show(" ","成功新增會議室",u["b"].options.success),e.next=21;break;case 16:e.prev=16,e.t0=e["catch"](0),t.isProcessing=!1,t.$toast.error(" ","新增失敗，請稍後再試",u["b"].options.error),console.log(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,16]])})))()},deleteRoom:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(n.prev=0,e.isProcessing=!0,t){n.next=4;break}return n.abrupt("return",e.$toast.error(" ","操作錯誤，請稍後再試",u["b"].options.error));case 4:return n.next=6,m["a"].getRoomReserve({RoomId:t});case 6:if(r=n.sent,200===r.status){n.next=9;break}throw new Error(r.statusText);case 9:if(!r.data.length){n.next=12;break}return e.isProcessing=!1,n.abrupt("return",e.$toast.error(" ","該會議室已有預定，無法刪除",u["b"].options.error));case 12:return n.next=14,m["a"].deleteRoom({id:t});case 14:if(s=n.sent,200===s.status){n.next=17;break}throw new Error(s.statusText);case 17:e.fetchData(),e.isProcessing=!1,e.$toast.show(" ","成功刪除會議室",u["b"].options.success),n.next=27;break;case 22:n.prev=22,n.t0=n["catch"](0),e.isProcessing=!1,e.$toast.error(" ","刪除失敗，請稍後再試",u["b"].options.error),console.log(n.t0);case 27:case"end":return n.stop()}}),n,null,[[0,22]])})))()}},created:function(){this.fetchData()}},p=d,b=n("2877"),f=Object(b["a"])(p,r,s,!1,null,null,null);e["default"]=f.exports},"498a":function(t,e,n){"use strict";var r=n("23e7"),s=n("58a8").trim,a=n("c8d2");r({target:"String",proto:!0,forced:a("trim")},{trim:function(){return s(this)}})},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var r=n("1d80"),s=n("5899"),a="["+s+"]",o=RegExp("^"+a+a+"*"),i=RegExp(a+a+"*$"),c=function(t){return function(e){var n=String(r(e));return 1&t&&(n=n.replace(o,"")),2&t&&(n=n.replace(i,"")),n}};t.exports={start:c(1),end:c(2),trim:c(3)}},"7d03":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{staticClass:"nav"},[n("li",{staticClass:"nav-item"},[n("router-link",{staticClass:"nav-link active",attrs:{to:"/admin/rooms"}},[t._v(" 會議室管理 ")])],1),n("li",{staticClass:"nav-item"},[n("router-link",{staticClass:"nav-link ",attrs:{to:"/admin/users"}},[t._v("使用者管理")])],1)])},s=[],a={name:"AdminNavbar"},o=a,i=n("2877"),c=Object(i["a"])(o,r,s,!1,null,null,null);e["a"]=c.exports},c8d2:function(t,e,n){var r=n("d039"),s=n("5899"),a="​᠎";t.exports=function(t){return r((function(){return!!s[t]()||a[t]()!=a||s[t].name!==t}))}}}]);
//# sourceMappingURL=chunk-23731482.ade2139b.js.map